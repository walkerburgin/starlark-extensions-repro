# `starlark-extensions-repro`

This is a standalone playground for trying two different issues

1. Getting an `aspect-cli` starlark configuration extension to correctly declare dependencies on a `js_library()` generated by `bazel configure`. To repro, run `bazel configure` and observe an error like this:
    ```
    Updating BUILD files for javascript, aspect-configure
    Resolution error Import "@monorepo/postcss-config" from "postcss.config.mjs" is an unknown dependency. Possible solutions:
      1. Instruct Gazelle to resolve to a known dependency using a directive:
        # gazelle:resolve [src-lang] postcss import-string label
    ```
1. Getting `aspect-cli` configure to pick up dependencies on generated TypeScript files. To repro, delete `# gazelle:js_ignore_imports **/*.css` in `pkgs/foo-lib/BUILD.bazel`, run `bazel configure`, and observe an error like this:
    ```
    Updating BUILD files for javascript, aspect-configure
    Failed to validate dependencies for target "//pkgs/foo-lib:typescript":

    Import "./Foo.module.css" from "pkgs/foo-lib/src/Foo.tsx" is an unknown dependency. Possible solutions:
      1. Instruct Gazelle to resolve to a known dependency using a directive:
        # gazelle:resolve [src-lang] js import-string label
          or
        # gazelle:js_resolve import-string-glob label
      2. Ignore the dependency using the '# gazelle:js_ignore_imports ./Foo.module.css' directive.
      3. Disable Gazelle resolution validation using '# gazelle:js_validate_import_statements off'
    ```